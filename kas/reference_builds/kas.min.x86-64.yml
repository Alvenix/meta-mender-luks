header:
  version : 1
  includes:
    - ../kas.yml

machine: genericx86-64
distro : poky
target : core-image-minimal

local_conf_header:
  01_meta-mender-luks: |
    MENDER/LUKS_PASSWORD                  = "n3w_p@ssw0rd"
    MENDER/LUKS_BYPASS_RANDOM_KEY         = "1"
    MENDER/LUKS_BYPASS_ENCRYPTION         = "0"

  01_meta-mender: |
    INHERIT                              += "mender-full"
    MENDER_ARTIFACT_NAME                 ?= "rel-DEV"
    MENDER_STORAGE_TOTAL_SIZE_MB          = "4096"
    MENDER_DATA_PART_SIZE_MB              = "1024"
    MENDER_BOOT_PART_SIZE_MB              = "256"

  01_meta-mender-device: |
    MENDER_STORAGE_DEVICE                 = "/dev/sda"

  01_meta-mender-kernel: |
    MENDER/KERNEL_PART_SIZE_MB            = "256"

  ##############################################################################
  05_package_classes: |
    PACKAGE_CLASSES                      ?= "package_rpm"

  05_image_features: |
    IMAGE_FEATURES:remove                 = " splash"
    EXTRA_IMAGE_FEATURES                 ?= "allow-empty-password debug-tweaks"

  05_user_classes: |
    USER_CLASSES                         ?= "buildstats"

  05_shell_config: |
    PATCHRESOLVE                          = "noop"

  90_parallel: |
    PARALLEL_MAKE                         = "-j ${@oe.utils.cpu_count()}"
    BB_NUMBER_THREADS                     =    "${@oe.utils.cpu_count()}"

  90_diskmon: |
    BB_DISKMON_DIRS                     ??= " \
        STOPTASKS,${TMPDIR},1G,100K           \
        STOPTASKS,${DL_DIR},1G,100K           \
        STOPTASKS,${SSTATE_DIR},1G,100K       \
        STOPTASKS,/tmp,100M,100K              \
        HALT,${TMPDIR},100M,1K                \
        HALT,${DL_DIR},100M,1K                \
        HALT,${SSTATE_DIR},100M,1K            \
        HALT,/tmp,10M,1K"

bblayers_conf_header:
  standard: |
    LCONF_VERSION                         = "7"
    BBPATH                                = "${TOPDIR}"
    BBFILES                              ?= ""
